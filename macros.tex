\newcommand{\psiv}[1]{{\color{Emerald}#1--Psi.}}
\newcommand{\Albert}[1]{{\color{purple}Albert: #1}}
\newcommand{\Aru}[1]{{\color{blue}Aru: #1}}

\newcommand{\gp}{\mathsf{gp}}
\newcommand{\commit}{\mathsf{Commit}}
\newcommand{\open}{\mathsf{Open}}
\newcommand{\evaluation}{\mathsf{Evaluation}}
\newcommand{\testingP}{\mathsf{Testing Phase}}
\newcommand{\evaluationP}{\mathsf{Evaluation Phase}}
\newcommand{\com}{\mathsf{com}}


\newcommand{\code}{\mathcal{C}}

\newcommand{\polyspace}{(\QQ[X])[\vec Y]}


\newcommand{\encode}{\mathsf{Enc}}


\newcommand{\size}{2^\mu}
\newcommand{\matrixU}{\mathbf{\hat{u}}}
\newcommand{\matrixV}{\mathbf{V}}
\newcommand{\vectorUi}{\mathbf{\hat{u}_i}}
\newcommand{\oracleUi}{\llbracket\mathbf{\hat{u}}_i\rrbracket}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% FORMATTING
%

\interfootnotelinepenalty=10000

\newcommand{\keywords}[1]{\bigskip\par\noindent{\textbf{Keywords\/}: #1}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% THEOREMS
\theoremstyle{plain} % italics
\newtheorem{itheorem}{Theorem}%[section]
\newtheorem{icorollary}{Corollary}%[section]
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{claim}[theorem]{Claim}
\newtheorem{assumption}{Assumption}
\newtheorem{construction}{Construction}
\theoremstyle{definition} % not italics
\newtheorem{idefinition}{Definition}%[section]
\newtheorem{definition}[theorem]{Definition}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{example}[theorem]{Example}
\theoremstyle{remark} %
\newtheorem{case}{Case}
\crefname{assumption}{Assumption}{Assumptions}
\crefname{step}{Step}{Steps}
\crefname{figure}{Figure}{Figures}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Make \emph meaningful in italic environments (e.g., when using \theoremstyle{plain})
\renewcommand\eminnershape{\itshape\sffamily}

\newcommand{\emath}[1]{\ensuremath{#1}}
\newcommand{\newc}[2]{\newcommand{#1}{\ensuremath{#2}\xspace}}
\newcommand{\renewc}[2]{\renewcommand{#1}{\ensuremath{#2}\xspace}}

% allow in-line math breaks
\newcommand{\CB}{\allowbreak}

% such that in probability statements
\newcommand{\pST}{\; \middle| \;}
\DeclareMathOperator{\Concat}{\; || \; }
% \DeclareMathOperator{\max}{max}
\newcommand{\Or}{\vee}
\renewcommand{\And}{\wedge}
\newcommand{\Not}{\neg}
\newc{\defeq}{:=}
\newcommand{\Union}{\cup}
\newcommand{\defemph}[1]{\textbf{\emph{#1}}}

% some math macros
\newcommand{\List}[1]{\left[#1\right]}
\newcommand{\SmallList}[1]{[#1]}
\renewcommand{\set}[1]{\ensuremath{\mleft\{#1\mright\}}}
\newcommand{\Range}[2]{\set{#1, \dotsc, #2}}
\newcommand{\OpenOpen}[2]{\left[#1, #2\right]}
\newcommand{\OpenClosed}[2]{\left[#1, #2\right)}
\newcommand{\ClosedOpen}[2]{\left(#1, #2\right]}
\newcommand{\ClosedClosed}[2]{\left(#1, #2\right)}

\newcommand{\Element}[3]{#1_{#2,#3}}

% tuples with in-line math breaks
\newcommand{\tuple}[2]{(#1 ,\CB \dots,\CB #2)}
\newcommand{\pair}[2]{(#1 ,\CB #2)}
\newcommand{\ppair}[2]{\left(#1 ,\CB #2\right)}
\newcommand{\triple}[3]{(#1 ,\CB #2,\CB #3)}
\newcommand{\ptriple}[3]{\left(#1 ,\CB #2,\CB #3\right)}
\newcommand{\quadruple}[4]{(#1 ,\CB #2,\CB #3,\CB #4)}
\newcommand{\pquadruple}[4]{\left(#1 ,\CB #2,\CB #3,\CB #4\right)}
\newcommand{\quintuple}[5]{(#1 ,\CB #2,\CB #3,\CB #4,\CB #5)}
\newcommand{\quintuplenp}[5]{#1 ,\CB #2,\CB #3,\CB #4,\CB #5}
\newcommand{\sextuple}[6]{(#1 ,\CB #2,\CB #3,\CB #4,\CB #5,\CB #6)}
\newcommand{\sextuplenp}[6]{#1 ,\CB #2,\CB #3,\CB #4,\CB #5,\CB #6}
\newcommand{\septuple}[7]{(#1 ,\CB #2,\CB #3,\CB #4,\CB #5,\CB #6,\CB #7)}
\newcommand{\septuplenp}[7]{#1 ,\CB #2,\CB #3,\CB #4,\CB #5,\CB #6,\CB #7}
\newcommand{\octuple}[8]{(#1 ,\CB #2,\CB #3,\CB #4,\CB #5,\CB #6,\CB #7,\CB #8)}
\newcommand{\octuplenp}[8]{#1 ,\CB #2,\CB #3,\CB #4,\CB #5,\CB #6,\CB #7,\CB #8}
\newcommand{\nonuple}[9]{(#1 ,\CB #2,\CB #3,\CB #4,\CB #5,\CB #6,\CB #7,\CB #8,\CB #9)}
\newcommand{\nonuplenp}[9]{#1 ,\CB #2,\CB #3,\CB #4,\CB #5,\CB #6,\CB #7,\CB #8,\CB #9}

% expectation
\newcommand{\prob}[1]{\Pr\left[ #1 \right]}
\newcommand{\Expectation}{\mathbb{E}}

% random variable
\newcommand{\RandomVariable}{X}

% complexity classes
\newcommand{\Class}[1]{\mathsf{#1}}
\newcommand{\NP}{\Class{NP}}
\newcommand{\DTIME}[1]{\Class{DTIME}(#1)}

% types
\newc{\bits}{\{0,1\}}
\newc{\strings}{\bits^{*}}
\newc{\naturals}{\mathbb{N}}
\newc{\cmplx}{\mathbb{C}}
\newc{\reals}{\mathbb{R}}
\newc{\rationals}{\mathbb{Q}}
\newc{\integers}{\mathbb{Z}}
\newc{\integersq}{\mathbb{Z}_{\modulus}}
\newc{\integersp}{\mathbb{Z}_{\pmodulus}}
\newc{\integersalpha}{\mathbb{Z}_{\alpha}}
\newcommand{\integerball}[1]{\integers(#1)}
\newc{\preimagepowers}{P}

\newcommand{\EmptyString}{\varepsilon}

\newcommand{\field}{\mathbb{F}}
\newc{\ff}{\mathbb{F}_{\pmodulus}}
\newcommand{\Pairing}[2]{\PairingSymb(#1,\ #2)}
\newcommand{\fixMSM}{\textrm{f-MSM}}
\newcommand{\varMSM}{\textrm{v-MSM}}
\newcommand{\FFT}{\textrm{FFT}}
\newcommand{\IFFT}{\textrm{IFFT}}

\newcommand{\Max}{\mathsf{Max}}

\newcommand{\innerproduct}[2]{\langle #1, \ #2 \rangle}

\newc{\randpick}{\ {\gets}{\scriptstyle\$}\ }

\newcommand{\Size}[1]{\abs{#1}}
\newcommand{\Time}{t}

\renewc{\secparam}{\lambda}
\newc{\knowledgeerror}{\kappa}
\newcommand{\Deg}{\mathrm{deg}}
\newcommand{\VIEW}{\mathrm{View}}

% attackers
\newcommand{\QuerySampler}{\mathcal{Q}}
\newc{\adversary}{\mathcal{A}}
\newcommand{\adversaryb}{\mathcal{B}}
\newcommand{\adversaryd}{\mathcal{D}}
\newc{\experiment}{\mathsf{Exp}}
\newcommand{\Simulator}{\mathcal{S}}
\newcommand{\PCSimulator}{\mathcal{S}_{\PC}}
\newcommand{\SPCSimulator}{\mathcal{S}_{\mathsf{s}}}
\newcommand{\SqPCSimulator}{\mathcal{S}_{\mathsf{m}}}
\newcommand{\Real}{\mathsf{Real}}
\newcommand{\Ideal}{\mathcal{I}}
\newc{\extractoradversary}{\mathcal{E}_{\adversary}}
\newcommand{\Challenger}{\mathcal{C}}

% oracles
\newcommand{\HashOracle}{\rho}
\newcommand{\Oracle}{\mathcal{O}}
\newcommand{\OracleFamily}{\mathbb{O}}
\newcommand{\SuccessOracles}{\mathsf{S}}

% public parameters
\newcommand{\CRS}{\mathsf{crs}}
\newcommand{\td}{\mathsf{td}}
\newcommand{\PK}{\mathsf{PK}}

% relation, instance, witness
\newcommand{\Relation}{\mathcal{R}}
\newcommand{\Language}{\mathcal{L}}
\newcommand{\Index}{\mathbbm{i}}
\newcommand{\Instance}{\mathbbm{x}}
\newcommand{\InstanceSizeBound}{\mathsf{N}}
\newcommand{\RelationWithSizeBound}{\Relation_{\InstanceSizeBound}}

\newcommand{\ValidInstance}{\Language(\Relation)}
\newcommand{\ValidInstanceWithSizeBound}{\Language(\RelationWithSizeBound)}

\newcommand{\AuxiliaryInp}{\mathbbm{z}}
\newcommand{\AuxiliaryInpDistri}{\mathcal{Z}}
\newcommand{\aux}{\mathsf{aux}}


\newcommand{\polylog}{\mathrm{polylog}}
\newcommand{\hybrid}[1]{\ensuremath{\mathsf{Hyb}_{#1}\xspace}}

\newcommand{\vhl}[1]{{\color{blue} #1}}
\newcommand{\mhl}[1]{\text{\hl{$#1$}}}
\newcommand{\iseq}{\overset{?}{=}}
\newcommand{\isleq}{\overset{?}{\leq}}

% Hash families
\newcommand{\HashFamily}{\mathcal{H}}
\newcommand{\HashIndex}{I}
\newcommand{\HashKey}{I}
\newcommand{\HashIndexSet}{\mathcal{I}}
\newcommand{\Hash}{h}
\newcommand{\HashKeySpace}{\mathcal{I}}

% Transcripts
\newcommand{\TranscriptSet}{\mathcal{X}}
\newcommand{\challengeset}{\mathcal{H}}
\newcommand{\State}{\mathsf{st}}
\newcommand{\Transcript}{\tau}
\newcommand{\Tree}{\textnormal{\textsc{tree}}}
\newcommand{\EmptyTranscript}{\emptyset}
\newcommand{\StatesMultiRounds}[1]{[\State_i]_{i=1}^{\PCRound}}
\newcommand{\QueryTranscript}{\mathsf{qt}}
\newcommand{\Query}{q}
\newcommand{\NumQueries}{Q}
\newcommand{\QuerySet}{\mathcal{Q}}
\newcommand{\ChallengeSetSize}{p}
\newcommand{\Image}{\mathsf{Image}}

% Algebras
\newc{\ring}{\mathcal{R}}
\newc{\ideal}{\mathfrak{n}}
\newc{\ringdegree}{n}
\newc{\modulus}{q}
\newc{\pmodulus}{M}
\newc{\modq}{\bmod\modulus}
\newc{\modp}{\bmod\pmodulus}
\newc{\fring}{\ring_{\modulus}}
\newc{\pring}{\ring_{\pmodulus}}
\newc{\fringinvertiblesubset}{\ring_{\modulus}^{\times}}
\newc{\fringmultgroup}{\fring^{\times}}
\newcommand{\automorphism}[1]{\emath{\sigma_{-1}(#1)}}
\newcommand{\ltwonorm}[1]{\norm{#1}_{2}}
\newcommand{\linfinitynorm}[1]{\norm{#1}_{\infty}}

% Codes
\renewc{\dist}{\mathsf{dist}}
\renewc{\dim}{\mathsf{dim}}
\newc{\blocklength}{\mathsf{n}}
\newcommand{\reldist}[2]{\Delta\left(#1,#2\right)}

% Footnotes
\newcommand{\astfootnote}[1]{%
\let\oldthefootnote=\thefootnote%
\setcounter{footnote}{0}%
\renewcommand{\thefootnote}{\fnsymbol{footnote}}%
\footnote{#1}%
\addtocounter{footnote}{-1}%
\let\thefootnote=\oldthefootnote%
}

\newcommand\blfootnote[1]{%
  \begingroup
  \renewcommand\thefootnote{}\footnote{#1}%
  \addtocounter{footnote}{-1}%
  \endgroup
}

% Better paragraphs headers
\newcommand{\parhead}[1]{\medskip\noindent\textbf{#1}.\quad}