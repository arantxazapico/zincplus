\subsection{The protocol}

\newpage

\begin{figure}[H]
	\begin{framed}
		\begin{description}
			\item[$\commit(\gp, f)$:] $f\in\polyspace$, $\vec Y\in\FF^{2\mu}$ 
				\begin{itemize}
					\item Compute matrix $V^f$ of size $\size\times\size$ and coefficients in $\QQ[X]$ that represents $f$ the following way:
						$$\mathbf V^f=(f_{b_1, b_2}(X))_{b_1, b_2 \in \{0,1\}^\mu}\in \QQ[X]^{\size\times\size}$$
					\item For each $i\in[\size]$, compute
					 $\vectorUi=\encode(f_{i,b_2}(X))_{b_2\in\{0,1\}^\mu}\in\QQ[X]^n$ and matrix 
					 $\matrixU=(\vectorUi)_{i\in [\size]}\in\QQ[X]^{\size\times n}$
					\item Output $\com=(\oracleUi)_{i\in[\size]}$, where $\oracleUi$ denote oracles to $\vectorUi$
				\end{itemize}
			\item[$\open(\gp, \com, f, \matrixU)$:] \ \
				\begin{itemize}
					\item Parse $(\vectorUi)_{i\in[\size]}\gets\matrixU$ and $(\oracleUi)_{i\in[\size]}\gets\com$
					\item Check that $\com$ consists of oracles to $\vectorUi$ and that $\vectorUi$ is $\delta$-close to $\encode_\code(\matrixV^f_i)$ for all $i$. \Aru{how}
					\item Reject if at any moment reading $\hat{u}$, $f$, or $\com$ some coefficient is not in $\QQ[X]$ or is larger than $poly()$
				\end{itemize}		
		\item[$\evaluation$:] \
		\item[$\testingP:$]
				\begin{enumerate}
					\item $V$ sends $r_1, \ldots, r_{\size}\in[0, q_0-1]$ and $\mathbf \alpha=(\alpha_0, \ldots, \alpha_{Bdeg})\in[0, q_0-1]^{Bdeg}$
					\item $P$ computes and outputs 
					$$\mathbf{v}=\sum_{i\in[\size]}r_i\matrixV^f_i(\mathbf{\alpha})\in \QQ^{\size}$$
					\item $V$ randomly chooses $J\subset[n]$ with $|J|=\Theta(\delta)$ and for each $j\in J$
						\begin{itemize}
							\item If $\mathbf v_j$ is not an integer or $|\mathbf v_j|>...$, $V$ rejects
							\item Queries $\hat{u}_{1,j}(X), \ldots, \hat{u}_{\size, j}(X)\in \QQ[X]$
							\item Rejects if
							\item Computes $(\hat{u}_{i,j}(\mathbf \alpha))_{i\in[\size]}$
							\item $V$ checks whether $\encode(\mathbf v)_j=\sum_{i\in[\size]}r_i\hat{u}_{i,j}(\mathbf{\alpha})$
						\end{itemize}
				\end{enumerate}
		\item[$\evaluationP:$]				
				\begin{enumerate}
					\item $V$ sends $r_1, \ldots, r_{\size}\in[0, q_0-1]$ and $\mathbf \alpha=(\alpha_0, \ldots, \alpha_{Bdeg})\in[0, q_0-1]^{Bdeg}$
					\item $P$ computes and outputs 
					$$\mathbf{v}=\sum_{i\in[\size]}\phi(q_{1,r})\phi(\matrixV^f_i)\in \FF_q^{\size}$$
					\item $V$ randomly chooses $J\subset[n]$ with $|J|=\Theta(\delta)$ and for each $j\in J$
					\begin{itemize}
						\item If $\mathbf v_j$ is not an integer or $|\mathbf v_j|>...$, $V$ rejects
						\item $V$ checks whether $\encode(\mathbf v_{q, x-\theta})_j=\sum_{i\in[\size]}\phi(q_{1,i})\phi_q(\hat{u}_{i,j}(X))$ and $\phi(y)=\sum_{i\in[\size]}(\mathbf v_{q, x-\theta})_i\phi(q_{2,i})$
					\end{itemize}
				\end{enumerate}
		\end{description}		
	\end{framed}
\end{figure}
